import{ae as $,y as b,au as d,av as E,e as g,aw as m,j as k,ax as j,ad as u,ay as B,l as y,aj as A,az as I}from"./vidstack-1H0xyD-V-hgVHqCLM.js";import"./app-adpMbaRp.js";class M{constructor(t){this.B=b(""),this.fb=t,t.setAttribute("frameBorder","0"),t.setAttribute("allowfullscreen",""),t.setAttribute("allow","autoplay; encrypted-media; picture-in-picture;")}setup(t){g(this.gb.bind(this)),y(window,"message",this.hb.bind(this)),y(this.fb,"load",this.J.bind(this))}gb(){const t=this.B();if(!t.length){this.fb.setAttribute("src","");return}const s=A(()=>this.I());this.fb.setAttribute("src",I(t,s))}E(t,s){var e;(e=this.fb.contentWindow)==null||e.postMessage(JSON.stringify(t),s??"*")}hb(t){var a;const s=this.t();if(t.source===((a=this.fb)==null?void 0:a.contentWindow)&&(!k(s)||s===t.origin)){try{const h=JSON.parse(t.data);h&&this.L(h,t);return}catch{}t.data&&this.L(t.data,t)}}}var n=(i=>(i.Play="playVideo",i.Pause="pauseVideo",i.Seek="seekTo",i.Mute="mute",i.Unmute="unMute",i.SetVolume="setVolume",i.SetPlaybackRate="setPlaybackRate",i))(n||{}),o=(i=>(i[i.Unstarted=-1]="Unstarted",i[i.Ended=0]="Ended",i[i.Playing=1]="Playing",i[i.Paused=2]="Paused",i[i.Buffering=3]="Buffering",i[i.Cued=5]="Cued",i))(o||{});const c=class c extends M{constructor(){super(...arguments),this.$$PROVIDER_TYPE="YOUTUBE",this.scope=$(),this.j=b(""),this.k=-1,this.c=!0,this.q=!1,this.i=!1,this.l=-1,this.x=1,this.h=0,this.m=0,this.n=new d(0,0),this.o=1,this.r=!1,this.s=null,this.f=null,this.g=null,this.language="en",this.color="red",this.cookies=!1}get a(){return this.d.delegate.a}get currentSrc(){return this.s}get type(){return"video"}get videoId(){return this.j()}get paused(){return this.c}get muted(){return this.q}set muted(t){t?this.e(n.Mute):this.e(n.Unmute)}get currentTime(){return this.h}set currentTime(t){this.e(n.Seek,t)}get volume(){return this.x}set volume(t){this.e(n.SetVolume,t*100)}get playsinline(){return this.r}set playsinline(t){this.r=t}get playbackRate(){return this.o}set playbackRate(t){this.e(n.SetPlaybackRate,t)}preconnect(){const t=[this.t(),"https://www.google.com","https://i.ytimg.com","https://googleads.g.doubleclick.net","https://static.doubleclick.net"];for(const s of t)E(s,"preconnect")}setup(t){this.d=t,super.setup(t),g(this.y.bind(this)),g(this.z.bind(this)),this.a("provider-setup",this)}async play(){if(this.c)return this.f||(this.f=m(),setTimeout(()=>{var t;this.c&&((t=this.f)==null||t.reject("Timed Out."))},3e3)),this.e(n.Play),this.f.promise}async pause(){if(!this.c)return this.g||(this.g=m(),setTimeout(()=>{var t;this.c||(t=this.g)==null||t.reject("Timed out.")},3e3)),this.e(n.Pause),this.g.promise}async loadSource(t){var e;if(!k(t.src))return;const s=(e=t.src.match(c.w))==null?void 0:e[1];this.j.set(s??""),this.s=t}t(){return this.cookies?"https://www.youtube.com":"https://www.youtube-nocookie.com"}y(){if(this.A(),!this.j()){this.B.set("");return}this.B.set(`${this.t()}/embed/${this.videoId}`)}z(){const t=this.j(),s=c.p;if(!t){this.a("poster-change","");return}if(s.has(t)){const a=s.get(t);this.a("poster-change",a);return}const e=new AbortController;return this.C(t,e),()=>e.abort()}async C(t,s){try{const e=["maxresdefault","sddefault","hqdefault"];for(const a of e)for(const h of[!0,!1]){const r=this.D(t,a,h);if((await fetch(r,{mode:"no-cors",signal:s.signal})).status<400){c.p.set(t,r),this.a("poster-change",r);return}}}catch{}this.a("poster-change","")}D(t,s,e){return`https://i.ytimg.com/${e?"vi_webp":"vi"}/${t}/${s}.${e?"webp":"jpg"}`}I(){const{keyDisabled:t}=this.d.$props,{$iosControls:s}=this.d,{controls:e,muted:a,playsinline:h}=this.d.$state,r=e()||s();return{autoplay:0,cc_lang_pref:this.language,cc_load_policy:r?1:void 0,color:this.color,controls:r?1:0,disablekb:!r||t()?1:0,enablejsapi:1,fs:1,hl:this.language,iv_load_policy:r?1:3,mute:a()?1:0,playsinline:h()?1:0}}e(t,s){this.E({event:"command",func:t,args:s?[s]:void 0})}J(){window.setTimeout(()=>this.E({event:"listening"}),100)}F(t){this.d.delegate.K(void 0,t)}G(t,s){var h,r;const e=t===o.Playing,a=t===o.Buffering;switch(a&&this.a("waiting",void 0,s),this.c&&(a||e)&&(this.c=!1,(h=this.f)==null||h.resolve(),this.f=null,this.a("play",void 0,s)),t){case o.Cued:this.F(s);break;case o.Playing:this.a("playing",void 0,s);break;case o.Paused:this.c=!0,(r=this.g)==null||r.resolve(),this.g=null,this.a("pause",void 0,s);break;case o.Ended:this.i&&this.u(s),this.d.$state.loop()?window.setTimeout(()=>{this.e(n.Play)},200):(this.c=!0,this.a("pause",void 0,s),this.a("ended",void 0,s));break}this.k=t}H(t,s){const{duration:e}=this.d.$state,a=this.k===o.Ended?e():t,h={currentTime:a,played:this.m>=a?this.n:this.n=new d(0,this.m)};this.a("time-update",h,s),Math.abs(a-this.h)>1&&(this.i=!0,this.a("seeking",a,s)),this.h=a}v(t,s,e){const a={buffered:new d(0,t),seekable:s};this.a("progress",a,e),this.i&&t>this.h&&this.u(e)}u(t){this.i=!1,window.clearTimeout(this.l),this.l=window.setTimeout(()=>{this.a("seeked",this.h,t),this.l=-1},this.c?100:0)}L({info:t},s){var r;if(!t)return;const{title:e,duration:a,playbackRate:h}=this.d.$state;if(j(t.videoData)&&t.videoData.title!==e()&&this.a("title-change",t.videoData.title,s),u(t.duration)&&t.duration!==a()){if(u(t.videoLoadedFraction)){const l=((r=t.progressState)==null?void 0:r.loaded)??t.videoLoadedFraction*t.duration,p=new d(0,t.duration);this.v(l,p,s)}this.a("duration-change",t.duration,s)}if(u(t.playbackRate)&&t.playbackRate!==h()&&(this.o=t.playbackRate,this.a("rate-change",t.playbackRate,s)),t.progressState){const{current:l,seekableStart:p,seekableEnd:v,loaded:R,duration:f}=t.progressState;this.H(l,s),this.v(R,new d(p,v),s),f!==a()&&this.a("duration-change",f,s)}if(u(t.volume)&&B(t.muted)){const l={volume:t.volume/100,muted:t.muted};this.q=t.muted,this.a("volume-change",l,s)}u(t.playerState)&&t.playerState!==this.k&&this.G(t.playerState,s)}A(){this.k=-1,this.c=!0,this.i=!1,this.l=-1,this.m=0,this.n=new d(0,0),this.h=0,this.o=1,this.f=null,this.g=null}};c.p=new Map,c.w=/(?:youtu\.be|youtube|youtube\.com|youtube-nocookie\.com)\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=|)((?:\w|-){11})/;let w=c;export{w as YouTubeProvider};
